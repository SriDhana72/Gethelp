<!-- 1. CSS STYLES -->
<style>
    /* Wrapper: Positions the widget, background transparent */
    .crm-widget-wrapper {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        position: fixed;
        bottom: 30px;
        right: 30px;
        z-index: 999999;
        display: flex;
        flex-direction: column;
        align-items: flex-end;
        background: transparent;
        /* Ensure clicks pass through the empty space to the CRM behind */
        pointer-events: none; 
    }

    /* Allow clicking on the buttons inside the wrapper */
    .crm-widget-wrapper > * {
        pointer-events: auto;
    }

    .crm-widget-wrapper * {
        box-sizing: border-box;
    }

    :root {
        --crm-teal: #009688;
        --crm-teal-dark: #00796b;
        --crm-light-green: #e0f2f1;
    }

    /* --- MAIN GALAXY BUTTON --- */
    .crm-fab-main {
        width: 60px;
        height: 60px;
        background-color: var(--crm-teal);
        border-radius: 50%;
        border: none;
        color: white;
        cursor: pointer;
        position: relative;
        margin-top: 15px;
        outline: none;
        display: flex;
        align-items: center;
        justify-content: center;
        
        /* GALAXY EFFECT: Multi-layer shadow + Animation */
        box-shadow: 
            0 0 0 rgba(0, 150, 136, 0),         /* Inner Ring */
            0 0 20px rgba(0, 229, 255, 0.4),    /* Outer Cyan Glow */
            0 10px 20px rgba(0,0,0,0.4);        /* Deep Space Shadow */
            
        animation: galaxyFloat 3s ease-in-out infinite; /* The floating movement */
        transition: transform 0.3s, background-color 0.3s;
    }

    /* Hover Effect: Glow gets stronger and stops bobbing */
    .crm-fab-main:hover {
        background-color: var(--crm-teal-dark);
        transform: scale(1.1);
        box-shadow: 
            0 0 30px rgba(0, 229, 255, 0.6),    /* Intense Glow */
            0 15px 30px rgba(0,0,0,0.5);        /* Deeper Shadow */
        animation-play-state: paused; /* Stops floating when you try to click */
    }

    /* THE GALAXY ANIMATION (Bobbing up and down) */
    @keyframes galaxyFloat {
        0% { transform: translateY(0px); }
        50% { transform: translateY(-6px); } /* Moves up */
        100% { transform: translateY(0px); }
    }

    /* --- ICONS --- */
    .crm-main-icon {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        transition: all 0.3s ease;
    }
    /* Default State */
    .icon-chat { opacity: 1; transform: translate(-50%, -50%) scale(1); }
    .icon-close { opacity: 0; transform: translate(-50%, -50%) rotate(-90deg); }
    
    /* Active State (When clicked) */
    .crm-fab-main.active .icon-chat { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
    .crm-fab-main.active .icon-close { opacity: 1; transform: translate(-50%, -50%) rotate(0deg); }


    /* --- OPTIONS MENU --- */
    .crm-fab-options {
        list-style: none;
        margin: 0;
        padding: 0;
        display: flex;
        flex-direction: column;
        gap: 15px;
        align-items: flex-end;
        visibility: hidden;
        pointer-events: none;
    }
    .crm-fab-options.show { visibility: visible; pointer-events: auto; }

    /* Rows */
    .crm-fab-row {
        display: flex;
        align-items: center;
        justify-content: flex-end;
        gap: 12px;
        opacity: 0;
        transform: translateY(15px) scale(0.9);
        transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }
    .crm-fab-options.show .crm-fab-row { opacity: 1; transform: translateY(0) scale(1); }
    /* Delays */
    .crm-fab-options.show .row-1 { transition-delay: 0.05s; } /* Bottom (GC) */
    .crm-fab-options.show .row-2 { transition-delay: 0.1s; }  /* Top (Live Chat) */

    /* Mini Buttons */
    .crm-fab-mini {
        width: 45px;
        height: 45px;
        border-radius: 50%;
        border: none;
        background-color: white;
        color: var(--crm-teal);
        box-shadow: 0 3px 8px rgba(0,0,0,0.2);
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: transform 0.2s, background-color 0.2s;
    }
    .crm-fab-mini:hover { transform: scale(1.1); }
    .crm-fab-mini:active { background-color: var(--crm-light-green); transform: scale(0.95); }

    /* Labels */
    .crm-fab-label {
        background-color: white;
        color: #333;
        padding: 5px 10px;
        border-radius: 4px;
        font-size: 13px;
        font-weight: 700;
        text-transform: uppercase;
        box-shadow: 0 2px 5px rgba(0,0,0,0.15);
        white-space: nowrap;
        opacity: 0;
        transform: translateX(-10px);
        transition: opacity 0.3s, transform 0.3s;
    }
    .crm-fab-options.show .crm-fab-label { opacity: 1; transform: translateX(0); transition-delay: 0.15s; }

    /* Iframe Modal */
    .crm-modal {
        position: fixed;
        bottom: 100px;
        right: 30px;
        width: 360px;
        height: 500px;
        background: white;
        border-radius: 8px;
        box-shadow: 0 5px 30px rgba(0,0,0,0.2);
        display: none;
        flex-direction: column;
        overflow: hidden;
        z-index: 100000;
        border: 1px solid #ddd;
        animation: slideUp 0.3s ease forwards;
    }
    @keyframes slideUp {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }
    .crm-modal-header {
        background-color: var(--crm-teal);
        color: white;
        padding: 12px 15px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    .crm-modal-title { font-weight: bold; font-size: 16px; }
    .crm-modal-close { background: none; border: none; color: white; font-size: 24px; cursor: pointer; padding: 0; line-height: 1; }
    .crm-iframe { flex: 1; border: none; width: 100%; background: #f9f9f9; }
</style>

<!-- 2. HTML ELEMENTS -->
<div class="crm-widget-wrapper">

    <!-- Options Menu -->
    <div class="crm-fab-options" id="crmOptions">
        
        <!-- Option 1: Live Chat (Top) -->
        <div class="crm-fab-row row-2">
            <span class="crm-fab-label">Live chat</span>
            <button class="crm-fab-mini" onclick="openOption('Live chat')">
                <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path></svg>
            </button>
        </div>

        <!-- Option 2: GC (Bottom) -->
        <div class="crm-fab-row row-1">
            <span class="crm-fab-label">GC</span>
            <button class="crm-fab-mini" onclick="openOption('GC')">
                <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>
            </button>
        </div>

    </div>

    <!-- Main Button -->
    <button class="crm-fab-main" id="crmMainBtn" onclick="toggleMenu()">
        <svg class="crm-main-icon icon-chat" width="26" height="26" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>
        <svg class="crm-main-icon icon-close" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
    </button>

    <!-- Iframe Window -->
    <div class="crm-modal" id="crmModal">
        <div class="crm-modal-header">
            <span class="crm-modal-title" id="crmModalTitle">Chat</span>
            <button class="crm-modal-close" onclick="closeCrmWindow()">&times;</button>
        </div>
        <iframe class="crm-iframe" id="crmIframe" src=""></iframe>
    </div>

</div>

<!-- 3. JAVASCRIPT -->
<script>
    /* CONFIGURATION */
    const urlConfig = {
        'Live chat': '', // Add your Live Chat URL here
        'GC': 'https://gc.zoho.in/org/60047034906/flows/3189000004821855'
    };

    /* LOGIC */
    const mainBtn = document.getElementById('crmMainBtn');
    const optionsMenu = document.getElementById('crmOptions');
    const modal = document.getElementById('crmModal');
    const iframe = document.getElementById('crmIframe');
    const modalTitle = document.getElementById('crmModalTitle');
    let isMenuOpen = false;

    function toggleMenu() {
        if (modal.style.display === 'flex') {
            closeCrmWindow();
            return;
        }
        isMenuOpen = !isMenuOpen;
        if (isMenuOpen) {
            optionsMenu.classList.add('show');
            mainBtn.classList.add('active');
        } else {
            optionsMenu.classList.remove('show');
            mainBtn.classList.remove('active');
        }
    }

    function openOption(type) {
        // Open GC in new tab to fix iframe blocking issues
        if (type === 'GC') {
            window.open(urlConfig['GC'], '_blank'); 
            toggleMenu(); 
            return;
        }

        // Open Live Chat in the widget
        toggleMenu();
        mainBtn.classList.add('active'); 
        isMenuOpen = true;

        modalTitle.innerText = type;
        iframe.src = urlConfig[type] || 'about:blank';
        modal.style.display = 'flex';
    }

    function closeCrmWindow() {
        modal.style.display = 'none';
        iframe.src = ''; 
        mainBtn.classList.remove('active');
        optionsMenu.classList.remove('show');
        isMenuOpen = false;
    }
</script>